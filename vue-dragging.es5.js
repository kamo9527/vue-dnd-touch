!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueDragging=t()}(this,function(){"use strict";var e={on:function(e,t,n){e.addEventListener(t,n)},off:function(e,t,n){e.removeEventListener(t,n)},addClass:function(e,t){if(arguments.length<2)e.classList.add(t);else for(var n=1,o=arguments.length;n<o;n++)e.classList.add(arguments[n])},removeClass:function(e,t){if(arguments.length<2)e.classList.remove(t);else for(var n=1,o=arguments.length;n<o;n++)e.classList.remove(arguments[n])}};return function(t){var n="1"===t.version.split(".")[0],o=-1,i=null,r="",u={},d={},l=document.createElement("img"),a=document.getElementById("app");function s(e,t){l.style.left=e-40+"px",l.style.top=t-40+"px"}function g(e){e.stopPropagation(),e.preventDefault();var t=p(e.target),n=t.getAttribute("drag_key"),i=t.getAttribute("drag_group"),a=e.touches[0];if((r=u[i][n])&&(o=n,l=document.querySelector(".vue_dnd_img"),s(a.pageX,a.pageY),l.src=r,l.style.display="block"),d[i].length!==u[i].length)for(var g=t.parentNode.childNodes,c=document.documentElement.scrollTop||document.body.scrollTop,f=document.documentElement.scrollLeft||document.body.scrollLeft,h=0;h<g.length;h++){var v=g[h].getBoundingClientRect(),m={top:v.top+c,left:v.left+f,width:v.width,height:v.height};d[i].push(m)}}function c(e){e.stopPropagation(),e.preventDefault(),s((i=e.touches[0]).pageX,i.pageY)}function f(e){var t=p(e.target).getAttribute("drag_group");if(o>-1&&i){if(!d[t]||0===d[t].length)return;if(!u[t]||0===u[t].length)return;var n=d[t].findIndex(function(e){return e.left<=i.pageX&&i.pageX<=e.left+e.width&&e.top<=i.pageY&&i.pageY<=e.top+e.height});if(n>-1){var a=u[t][n];u[t].splice(o,1,a),u[t].splice(n,1,r)}}l.style.display="none",i=null,o=-1,l.src=""}function p(e){if(e)for(;e.parentNode;){if(e.getAttribute&&e.getAttribute("drag_group"))return e;e=e.parentNode}}function h(t,o,i){var r=o.value.list,l=o.value.group,a=n?o.value.key:i.key;r&&r.length>0&&(u[l]=r,d[l]=[]),t.setAttribute("drag_group",o.value.group),t.setAttribute("drag_key",a),e.on(t,"touchstart",g),e.on(t,"touchmove",c),e.on(t,"touchend",f)}function v(t){e.off(t,"touchstart",g),e.off(t,"touchmove",c),e.off(t,"touchend",f)}l.src="",e.addClass(l,"vue_dnd_img"),l.style.display="none",a.appendChild(l),l=document.querySelector(".vue_dnd_img"),n?t.directive("dragging",{update:function(e,t){h(this.el,{modifiers:this.modifiers,arg:this.arg,value:e,oldValue:t})},unbind:function(e,t){v(this.el,(this.modifiers,this.arg,e||this.el.getAttribute("drag_group")))}}):t.directive("dragging",{bind:h,unbind:v})}});

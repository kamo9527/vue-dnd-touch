!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueDragging=t()}(this,function(){"use strict";var e={on:function(e,t,n){e.addEventListener(t,n)},off:function(e,t,n){e.removeEventListener(t,n)},addClass:function(e,t){if(arguments.length<2)e.classList.add(t);else for(var n=1,o=arguments.length;n<o;n++)e.classList.add(arguments[n])},removeClass:function(e,t){if(arguments.length<2)e.classList.remove(t);else for(var n=1,o=arguments.length;n<o;n++)e.classList.remove(arguments[n])}};return function(t){var n="1"===t.version.split(".")[0],o=-1,r=null,i="",u={},a={},d=document.createElement("img"),l=document.getElementById("app");function g(e,t){d.style.left=e-40+"px",d.style.top=t-40+"px"}function s(e){e.stopPropagation(),e.preventDefault();var t=p(e.target),n=t.getAttribute("drag_key"),r=t.getAttribute("drag_group"),l=t.getAttribute("url_key"),s=e.touches[0];if((i=u[r][n][l])&&(o=n,d=document.querySelector(".vue_dnd_img"),g(s.pageX,s.pageY),d.src=i,d.style.display="block"),a[r].length!==u[r].length)for(var f=t.parentNode.children,c=document.documentElement.scrollTop||document.body.scrollTop,h=document.documentElement.scrollLeft||document.body.scrollLeft,v=0;v<f.length;v++){var m=f[v];if(m.getAttribute&&m.getAttribute("drag_group")){var y=m.getBoundingClientRect(),b={top:y.top+c,left:y.left+h,width:y.width,height:y.height};a[r].push(b)}}}function f(e){e.stopPropagation(),e.preventDefault(),g((r=e.touches[0]).pageX,r.pageY)}function c(e){var t=p(e.target),n=t.getAttribute("drag_group"),l=t.getAttribute("url_key");if(o>-1&&r){if(!a[n]||0===a[n].length)return;if(!u[n]||0===u[n].length)return;var g=a[n].findIndex(function(e){return e.left<=r.pageX&&r.pageX<=e.left+e.width&&e.top<=r.pageY&&r.pageY<=e.top+e.height});if(g>-1){var s=u[n][g][l];u[n][o][l]=s,u[n][g][l]=i}}d.style.display="none",r=null,o=-1,d.src=""}function p(e){if(e)for(;e.parentNode;){if(e.getAttribute&&e.getAttribute("drag_group"))return e;e=e.parentNode}}function h(t,o,r){var i=o.value.list,d=o.value.group,l=n?o.value.key:r.key;i&&i.length>0&&(u[d]=i,a[d]=[]),t.setAttribute("drag_group",o.value.group),t.setAttribute("url_key",o.value.key),t.setAttribute("drag_key",l),e.on(t,"touchstart",s),e.on(t,"touchmove",f),e.on(t,"touchend",c)}function v(t){e.off(t,"touchstart",s),e.off(t,"touchmove",f),e.off(t,"touchend",c)}d.src="",e.addClass(d,"vue_dnd_img"),d.style.display="none",l.appendChild(d),d=document.querySelector(".vue_dnd_img"),n?t.directive("dragging",{update:function(e,t){h(this.el,{modifiers:this.modifiers,arg:this.arg,value:e,oldValue:t})},unbind:function(e,t){v(this.el,(this.modifiers,this.arg,e||this.el.getAttribute("drag_group")))}}):t.directive("dragging",{bind:h,unbind:v})}});
